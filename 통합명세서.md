# 프로젝트 통합 문서: 소비재판소 (Shopping Court)

## 0. 중요 숙지내용
* **플랫폼** : 본 서비스는 **'앱인토스'**에 출시될 예정입니다.
* **준수 사항** : 개발의 모든 단계에서 **'앱인토스 개발자 센터'**에 공시된 가이드라인을 무조건적으로 따르며, 해당 플랫폼의 특수성을 반영하여 아키텍처 및 UI/UX를 설계해야 합니다.


## 1. 서비스 개요 및 핵심 컨셉
* **한 줄 설명**: 사용자가 자신의 소비 계획을 게시하면, 다른 사용자들이 투표와 댓글을 통해 해당 소비가 합리적인지 판결하는 커뮤니티 서비스입니다. 
* **주요 흐름**: 닉네임 생성 → 게시글 탐색 및 상세 진입 → 투표 참여 → 댓글 작성 및 토론 → 48시간 후 판결 확정 및 결과 열람. 

## 2. 사용자 및 커뮤니티 규칙
* **닉네임 시스템**: 실명 없이 활동하며, 중복 시 숫자가 자동으로 부여됩니다 (예: 사용자1, 사용자2). 생성 이후 변경은 불가능합니다. 
* **게시글 작성**: 제목과 설명을 필수로 작성하며, 연령대, 현재 상황, 직업, 소비 대상, 가격을 포함하도록 가이드라인이 상시 노출됩니다. 
* **투표 및 댓글 규칙**: 
    * 투표 항목은 '합리적이다(무죄)'와 '비합리적이다(유죄)' 두 가지이며, 게시글당 1회만 가능합니다.
    * 투표 완료 후에는 선택을 변경할 수 없습니다. 
    * **투표 후 댓글 작성**: 투표를 마친 사용자만 댓글을 쓸 수 있으며, 댓글에는 작성자의 투표 결과가 함께 표시됩니다. 
    * 좋아요 기능만 제공하며 싫어요 기능은 없습니다. 

## 3. 핵심 비즈니스 로직 및 시스템 설계
* **판결 확정 시스템**:
    * 게시글은 작성 시점부터 48시간 동안만 활성 상태를 유지합니다. 
    * 48시간 경과 시 자동으로 '판결 완료' 상태로 전환되며, 투표와 댓글 작성이 비활성화됩니다.
    * 판결 결과는 다수결에 따라 유죄/무죄/판결 보류(동률 시)로 결정되며 도장 형태로 표시됩니다. 
* **인기 게시글(실시간 인기 투표)**:
    * **산정 공식**: `판단 지표 = 투표 수 + (댓글 수 × 2)`. 
    * 동일 사용자의 댓글은 점수 산정 시 1개만 반영됩니다. 
    * 지표가 높은 글은 홈 화면 상단 '실시간 인기 투표' 영역에 노출됩니다. 
* **포인트 보상 시스템**:
    * 최초 1회 투표 시 1포인트를 지급합니다. 
    * 게시글이 인기 게시글 상태로 마감될 경우, 해당 글에 투표한 사용자에게 추가 포인트를 일괄 지급합니다. 

## 4. 기술 스택 (Tech Stack)
* **Frontend**: React, Vite, TypeScript를 사용하며, Toss Design System(TDS)을 적용하여 토스 앱과 동일한 UX를 제공합니다. 
* **Backend & DB**: Firebase (Serverless) 기반으로 Firestore(NoSQL)를 사용하며, 실시간 데이터 반영에 최적화합니다. 
* **인증 및 스토리지**: Firebase Authentication으로 사용자 인증을 처리하고 Firebase Storage에 이미지를 저장합니다. 
* **서버 로직**: Cloud Functions를 통해 투표 마감 처리 및 판결 확정 기능을 자동화합니다. 

## 5. 데이터 구조 (Firestore) 
* **users**: `userId` 
* **cases**: `caseId`, `title`, `content`, `images[]`, `guiltyCount`, `innocentCount`, `voteEndAt`, `status(OPEN/CLOSED)`, `hotScore`, `createdAt` 
* **votes**: `caseId_userId`, `caseId`, `userId`, `voteType` 
* **comments**: `caseId`, `commentId` 